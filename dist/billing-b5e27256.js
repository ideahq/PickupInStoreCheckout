(window.webpackJsonpCheckout=window.webpackJsonpCheckout||[]).push([[4],{1255:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(2),r=n(4);function o(e,t){return!(!e||!t)&&Object(r.isEqual)(i(e),i(t))}function i(e){return Object(r.omit)(a.__assign({},e,{customFields:(e.customFields||[]).filter(function(e){return!!e.fieldValue})}),["id","stateOrProvinceCode","type","email"])}},1269:function(e,t,n){"use strict";var a=n(2),r=n(15),o=n.n(r),i=n(0),s=n.n(i),l=n(282),c=n(283),d=Object(i.forwardRef)(function(e,t){var n=e.additionalClassName,r=e.label,i=e.id,d=a.__rest(e,["additionalClassName","label","id"]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(l.a,a.__assign({},d,{className:o()("form-checkbox","optimizedCheckout-form-checkbox",n),id:i,ref:t,type:"checkbox"})),s.a.createElement(c.a,{htmlFor:i},r))});t.a=d},1273:function(e,t,n){},1274:function(e,t,n){},1275:function(e,t,n){},1281:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n(288);function r(e){return Object(a.a)(e.lineItems.physicalItems.filter(function(e){return!e.addedByPromotion}))}},1287:function(e,t,n){"use strict";var a=n(2),r=n(0),o=n.n(r),i=n(1256),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={shouldShow:!1},t.handleClick=function(e){t.state.shouldShow?t.handleClose(e.nativeEvent):t.handleOpen(e.nativeEvent)},t.handleOpen=function(){t.state.shouldShow||t.setState({shouldShow:!0},function(){document.addEventListener("click",t.handleClose)})},t.handleClose=function(){t.state.shouldShow&&t.setState({shouldShow:!1},function(){document.removeEventListener("click",t.handleClose)})},t}return a.__extends(t,e),t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.handleClose)},t.prototype.render=function(){var e=this,t=this.props,n=t.children,r=t.placement,s=t.dropdown,l=this.state.shouldShow;return o.a.createElement(i.Manager,null,o.a.createElement(i.Reference,null,function(t){var a=t.ref;return o.a.createElement("div",{className:"dropdownTrigger",onClick:e.handleClick,ref:a},n)}),o.a.createElement(i.Popper,{modifiers:{hide:{enabled:!1},flip:{enabled:!1},preventOverflow:{enabled:!1}},placement:r},function(e){var t=e.ref,n=e.style;return l?o.a.createElement("div",{className:"dropdownMenu",ref:t,style:a.__assign({},n,{width:"100%",zIndex:1})},s):null}))},t.defaultProps={placement:"bottom-start"},t}(r.Component);t.a=s},1308:function(e,t,n){"use strict";var a=n(2),r=n(15),o=n.n(r),i=n(0),s=n.n(i),l=Object(i.forwardRef)(function(e,t){var n=e.additionalClassName,r=e.testId,i=e.className,l=a.__rest(e,["additionalClassName","testId","className"]);return s.a.createElement("textarea",a.__assign({},l,{className:i||o()("form-input","optimizedCheckout-form-input",n),"data-test":r,ref:t}))});t.a=l},1332:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(2),r=n(4);function o(e){var t=e.customFields,n=a.__rest(e,["customFields"]),o=[];return Object(r.forIn)(t,function(e,t){return o.push({fieldId:t,fieldValue:Object(r.isDate)(e)?e.toISOString().slice(0,10):e})}),a.__assign({},n,{customFields:o})}},1333:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n(4),r=n(1255),o=n(287);function i(e,t,n){return!(!e||!Object(o.a)(e,n))&&Object(a.some)(t,function(t){return Object(r.a)(t,e)})}},1334:function(e,t,n){"use strict";var a=n(2),r=n(0),o=n.n(r),i=n(1229),s=n(1202),l=n(1287),c=n(1255),d=n(1209),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelectAddress=function(e){var n=t.props,a=n.onSelectAddress,r=n.selectedAddress;Object(c.a)(r,e)||a(e)},t.handleUseNewAddress=function(){var e=t.props,n=e.selectedAddress;(0,e.onUseNewAddress)(n)},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.addresses,n=e.selectedAddress;return o.a.createElement("div",{className:"form-field"},o.a.createElement("div",{className:"dropdown--select",role:"combobox"},o.a.createElement(l.a,{dropdown:o.a.createElement(m,{addresses:t,onSelectAddress:this.handleSelectAddress,onUseNewAddress:this.handleUseNewAddress,selectedAddress:n})},o.a.createElement(p,{addresses:t,selectedAddress:n}))))},t}(r.PureComponent),m=function(e){var t=e.addresses,n=e.onSelectAddress,a=e.onUseNewAddress,r=e.selectedAddress;return o.a.createElement("ul",{className:"dropdown-menu instrumentSelect-dropdownMenu",id:"addressDropdown"},o.a.createElement("li",{className:"dropdown-menu-item dropdown-menu-item--select"},o.a.createElement("a",{href:"#",onClick:Object(i.a)(function(){return a(r)})},o.a.createElement(s.a,{id:"address.enter_address_action"}))),t.map(function(e){return o.a.createElement("li",{className:"dropdown-menu-item dropdown-menu-item--select",key:e.id},o.a.createElement("a",{href:"#",onClick:Object(i.a)(function(){return n(e)})},o.a.createElement(d.a,{address:e})))}))},p=function(e){var t=e.selectedAddress;return o.a.createElement("a",{className:"button dropdown-button dropdown-toggle--select",href:"#",id:"addressToggle",onClick:Object(i.a)()},t?o.a.createElement(d.a,{address:t}):o.a.createElement(s.a,{id:"address.enter_address_action"}))};t.a=Object(r.memo)(u)},1382:function(e,t,n){"use strict";var a=n(2),r=n(15),o=n.n(r),i=n(0),s=n.n(i),l=n(282),c=n(283),d=Object(i.forwardRef)(function(e,t){var n=e.additionalClassName,r=e.label,i=e.value,d=e.checked,u=e.id,m=a.__rest(e,["additionalClassName","label","value","checked","id"]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(l.a,a.__assign({},m,{checked:d,className:o()("form-radio","optimizedCheckout-form-radio",n),id:u,ref:t,type:"radio",value:i})),s.a.createElement(c.a,{htmlFor:u},r))});t.a=d},1383:function(e,t,n){"use strict";var a=n(2),r=n(0),o=n.n(r),i=n(1202),s=n(283),l=n(1236),c=n(1235),d=n(1234),u=n(1237);t.a=function(){var e=Object(r.useCallback)(function(e){return o.a.createElement(s.a,{hidden:!0,htmlFor:e},o.a.createElement(i.a,{id:"shipping.order_comment_label"}))},[]),t=Object(r.useCallback)(function(e){var t=e.field;return o.a.createElement(l.a,a.__assign({},t,{autoComplete:"off",maxLength:2e3}))},[]),n=Object(r.useMemo)(function(){return o.a.createElement(c.a,null,o.a.createElement(i.a,{id:"shipping.order_comment_label"}))},[]);return o.a.createElement(d.a,{legend:n,testId:"checkout-shipping-comments"},o.a.createElement(u.a,{input:t,label:e,name:"orderComment"}))}},1405:function(e,t,n){"use strict";var a=n(2),r=n(49),o=n(4),i=n(0),s=n.n(i),l=n(200),c=function(){function e(e){var t=e.address_components,n=e.name;this._name=n,this._address=t}return e.prototype.getState=function(){return this._get("administrative_area_level_1","short_name")},e.prototype.getStreet=function(){return this._name},e.prototype.getStreet2=function(){return""},e.prototype.getCity=function(){return this._get("postal_town","long_name")||this._get("locality","long_name")||this._get("neighborhood","short_name")},e.prototype.getCountry=function(){return this._get("country","short_name")},e.prototype.getPostCode=function(){return this._get("postal_code","short_name")},e.prototype._get=function(e,t){var n=this._address&&this._address.find(function(t){return-1!==t.types.indexOf(e)});return n?n[t]:""},e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.getState=function(){return this._get("administrative_area_level_2","long_name")},t.prototype.getStreet2=function(){return this._get("locality","long_name")},t}(c),u=function(){function e(){}return e.create=function(e){var t=new c(e);switch(t.getCountry()){case"GB":return new d(e)}return t},e}();var m=n(1202),p=n(1237),h={address1:"addressLine1",address2:"addressLine2",postalCode:"postCode",stateOrProvince:"province",stateOrProvinceCode:"provinceCode"};function g(e){return""+(h[e]||e)}function f(e){return g(e)+"Input"}var v=n(1295),_=n.n(v),b=(n(1274),function(e){var t=e.children;return s.a.createElement("div",{className:"popover"},t)});n(1275);function C(e,t){var n=["popoverList-item"];return e===t&&n.push("is-active"),n.join(" ")}var y,E=Object(i.memo)(function(e){var t=e.highlightedIndex,n=void 0===t?-1:t,r=e.testId,o=e.getItemProps,i=void 0===o?function(e){return e}:o,l=e.menuProps,c=void 0===l?{}:l,d=e.items;return d&&d.length?s.a.createElement("ul",a.__assign({className:"popoverList","data-test":r},c),d.map(function(e,t){return s.a.createElement("li",a.__assign({className:C(n,t),"data-test":r&&r+"-item"},i({key:e.id,index:t,item:e}),{key:t}),e.content)})):null}),O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stateReducer=function(e,n){var r=t.props.onChange;switch(n.type){case _.a.stateChangeTypes.blurInput:case _.a.stateChangeTypes.blurButton:case _.a.stateChangeTypes.mouseUp:case _.a.stateChangeTypes.touchEnd:return a.__assign({},n,{inputValue:e.inputValue});case _.a.stateChangeTypes.changeInput:return n.inputValue!==e.inputValue&&r&&r(n.inputValue||"",e.isOpen),n;case _.a.stateChangeTypes.keyDownEnter:default:return n}},t.handleStateChange=function(e){var n=e.isOpen,a=e.inputValue,r=t.props.onToggleOpen,i=void 0===r?o.noop:r;void 0!==n&&i({isOpen:n,inputValue:a||""})},t}return a.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.inputProps,r=t.initialValue,i=t.initialHighlightedIndex,l=t.items,c=t.children,d=t.onSelect,u=t.listTestId;return s.a.createElement(_.a,{defaultHighlightedIndex:0,initialHighlightedIndex:i,initialInputValue:r,itemToString:this.itemToString,onChange:d,onStateChange:this.handleStateChange,stateReducer:this.stateReducer},function(t){var r=t.isOpen,i=t.getInputProps,d=t.getMenuProps,m=t.getItemProps,p=t.highlightedIndex;return s.a.createElement("div",null,s.a.createElement("input",a.__assign({},i(),n)),r&&!!l.length&&s.a.createElement(b,null,s.a.createElement(E,{getItemProps:m,highlightedIndex:Object(o.isNumber)(p)?p:-1,items:l.map(function(t){return e.toPopoverItem(t)}),menuProps:d(),testId:u}),c))})},t.prototype.toPopoverItem=function(e){return a.__assign({},e,{content:this.highlightItem(e)})},t.prototype.highlightItem=function(e){if(!e.highlightedSlices||!e.highlightedSlices.length)return e.label;var t=0,n=0;return e.highlightedSlices.reduce(function(a,r,o){var l=e.label,c=r.offset,d=r.length,u=c-t;return u&&(a.push(s.a.createElement(i.Fragment,{key:n},l.substr(t,u))),n+=1),t=c+d,a.push(s.a.createElement("strong",{key:n},l.substr(c,d))),n+=1,o===(e.highlightedSlices||[]).length-1&&(a.push(s.a.createElement(i.Fragment,{key:n},l.substr(t))),n+=1),a},[])},t.prototype.itemToString=function(e){return e&&e.value||""},t}(i.PureComponent),S=(n(1273),n(1290)),A=function(){function e(){this._scriptLoader=Object(S.getScriptLoader)()}return e.prototype.loadMapsSdk=function(e){var t=this;return this._googleAutoComplete?this._googleAutoComplete:(this._googleAutoComplete=new Promise(function(n,a){var r=["language=en","key="+e,"libraries=places","callback=initAutoComplete"].join("&");window.initAutoComplete=function(){(function(e){var t=e;return Boolean(t.google&&t.google.maps&&t.google.maps.places)})(window)&&n(window.google.maps),a()},t._scriptLoader.loadScript("//maps.googleapis.com/maps/api/js?"+r).catch(function(e){throw t._googleAutoComplete=void 0,e})}),this._googleAutoComplete)},e}();var k=function(){function e(e,t){void 0===t&&(y||(y=new A),t=y),this._apiKey=e,this._scriptLoader=t}return e.prototype.getAutocompleteService=function(){return this._autocompletePromise||(this._autocompletePromise=this._scriptLoader.loadMapsSdk(this._apiKey).then(function(e){if(!e.places.AutocompleteService)throw new Error("`AutocompleteService` is undefined");return new e.places.AutocompleteService})),this._autocompletePromise},e.prototype.getPlacesServices=function(){var e=document.createElement("div");return this._placesPromise||(this._placesPromise=this._scriptLoader.loadMapsSdk(this._apiKey).then(function(t){if(!t.places.PlacesService)throw new Error("`PlacesService` is undefined");return new t.places.PlacesService(e)})),this._placesPromise},e}(),w=function(e){function t(t){var n=e.call(this,t)||this;return n.onSelect=function(e){var t=n.props,a=t.fields,r=t.onSelect,i=void 0===r?o.noop:r,s=t.nextElement;n.googleAutocompleteService.getPlacesServices().then(function(t){t.getDetails({placeId:e.id,fields:a||["address_components","name"]},function(t){s&&s.focus(),i(t,e)})})},n.onChange=function(e){var t=n.props,a=t.isAutocompleteEnabled,r=t.onChange;if((void 0===r?o.noop:r)(e,!1),!a)return n.resetAutocomplete();n.setAutocomplete(e),n.setItems(e)},n.googleAutocompleteService=new k(t.apiKey),n.state={items:[],autoComplete:"off"},n}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.initialValue,n=e.onToggleOpen,r=void 0===n?o.noop:n,i=e.inputProps,l=void 0===i?{}:i,c=this.state,d=c.autoComplete,u=c.items;return s.a.createElement(O,{initialHighlightedIndex:0,initialValue:t,inputProps:a.__assign({},l,{autoComplete:d}),items:u,listTestId:"address-autocomplete-suggestions",onChange:this.onChange,onSelect:this.onSelect,onToggleOpen:r},s.a.createElement("div",{className:"co-googleAutocomplete-footer"}))},t.prototype.setItems=function(e){var t=this;if(e){var n=this.props,a=n.componentRestrictions,r=n.types;this.googleAutocompleteService.getAutocompleteService().then(function(n){n.getPlacePredictions({input:e,types:r||["geocode"],componentRestrictions:a},function(e){return t.setState({items:t.toAutocompleteItems(e)})})})}else this.setState({items:[]})},t.prototype.resetAutocomplete=function(){this.setState({items:[],autoComplete:"off"})},t.prototype.setAutocomplete=function(e){this.setState(a.__assign({},this.state,{autoComplete:e&&e.length?"nope":"off"}))},t.prototype.toAutocompleteItems=function(e){return(e||[]).map(function(e){return{label:e.description,value:e.structured_formatting.main_text,highlightedSlices:e.matched_substrings,id:e.place_id}})},t}(i.PureComponent),N=Object(i.memo)(function(e){var t=e.field.name,n=e.countryCode,a=e.supportedCountries,r=e.parentFieldName,o=e.nextElement,l=e.apiKey,c=e.onSelect,d=e.onChange,u=e.onToggleOpen,h=r?r+"."+t:t,g=Object(i.useMemo)(function(){return s.a.createElement(m.a,{id:"address.address_line_1_label"})},[]),v=Object(i.useMemo)(function(){return{className:"form-input optimizedCheckout-form-input",id:f(t)}},[t]),_=Object(i.useCallback)(function(e){var t=e.field;return s.a.createElement(w,{apiKey:l,componentRestrictions:n?{country:n}:void 0,initialValue:t.value,inputProps:v,isAutocompleteEnabled:!!n&&a.indexOf(n)>-1,nextElement:o,onChange:d,onSelect:c,onToggleOpen:u})},[l,n,v,o,d,c,u,a]);return s.a.createElement("div",{className:"dynamic-form-field dynamic-form-field--addressLineAutocomplete"},s.a.createElement(p.a,{input:_,labelContent:g,name:h}))}),j=n(283),P=n(67),F=n(460),x=n(289),I=n(80),T=n(1296),M=n.n(T),V=n(1382),L=n(1269),R=n(1308),U=n(1236),z=Object(i.memo)(function(e){e.additionalClassName;var t=e.fieldType,n=e.id,r=e.name,l=e.onChange,c=void 0===l?o.noop:l,d=e.options,u=e.placeholder,m=e.value,p=a.__rest(e,["additionalClassName","fieldType","id","name","onChange","options","placeholder","value"]),h=Object(i.useCallback)(function(e,t){return c(a.__assign({},t,{target:{name:r,value:e}}))},[c,r]);switch(t){case I.a.dropdown:return s.a.createElement("select",a.__assign({},p,{className:"form-select optimizedCheckout-form-select","data-test":n+"-select",id:n,name:r,onChange:c,value:null===m?"":m}),u&&s.a.createElement("option",{value:""},u),d&&d.map(function(e){var t=e.label,n=e.value;return s.a.createElement("option",{key:n,value:n},t)}));case I.a.radio:return d&&d.length?s.a.createElement(s.a.Fragment,null,d.map(function(e){var t=e.label,o=e.value;return s.a.createElement(V.a,a.__assign({},p,{checked:o===m,id:n+"-"+o,key:o,label:t,name:r,onChange:c,testId:n+"-"+o+"-radio",value:o}))})):null;case I.a.checkbox:return d&&d.length?s.a.createElement(s.a.Fragment,null,d.map(function(e){var t=e.label,o=e.value;return s.a.createElement(L.a,a.__assign({},p,{checked:!!Array.isArray(m)&&m.includes(o),id:n+"-"+o,key:o,label:t,name:r,onChange:c,testId:n+"-"+o+"-checkbox",value:o}))})):null;case I.a.date:return s.a.createElement(M.a,a.__assign({},p,{autoComplete:"off",calendarClassName:"optimizedCheckout-contentPrimary",className:"form-input optimizedCheckout-form-input",maxDate:p.max?new Date(p.max+" 00:00:00"):void 0,minDate:p.min?new Date(p.min+" 00:00:00"):void 0,name:r,onChange:h,placeholderText:"MM/DD/YYYY",popperClassName:"optimizedCheckout-contentPrimary",selected:Object(o.isDate)(m)?m:void 0}));case I.a.multiline:return s.a.createElement(R.a,a.__assign({},p,{id:n,name:r,onChange:c,testId:n+"-text",type:t,value:m}));default:return s.a.createElement(U.a,a.__assign({},p,{id:n,name:r,onChange:c,testId:n+"-"+(t===I.a.password?"password":"text"),type:t,value:m}))}}),D=Object(i.memo)(function(e){var t=e.testId,n=e.onSelectedAll,a=e.onSelectedNone,r=Object(i.useCallback)(function(e){e.preventDefault(),n()},[n]),o=Object(i.useCallback)(function(e){e.preventDefault(),a()},[a]);return s.a.createElement("ul",{className:"multiCheckbox--controls"},s.a.createElement("li",{className:"multiCheckbox--control"},s.a.createElement(m.a,{id:"address.select"})),s.a.createElement("li",{className:"multiCheckbox--control"},s.a.createElement("a",{"data-test":t+"Checkbox-all-button",href:"#",onClick:r},s.a.createElement(m.a,{id:"address.select_all"}))),s.a.createElement("li",{className:"multiCheckbox--control"},s.a.createElement("a",{"data-test":t+"Checkbox-none-button",href:"#",onClick:o},s.a.createElement(m.a,{id:"address.select_none"}))))}),B=function(e){var t=e.form,n=t.values,a=t.errors,r=e.id,l=e.label,c=e.name,d=e.onChange,u=void 0===d?o.noop:d,m=e.options,p=e.pop,h=e.push,g=e.remove,f=Object(i.useCallback)(function(){var e=Object(P.getIn)(n,c)||[];Object(o.difference)(m.map(function(e){return e.value}),e).forEach(function(e){return h(e)}),u(Object(P.getIn)(n,c))},[c,u,m,h,n]),v=Object(i.useCallback)(function(){(Object(P.getIn)(n,c)||[]).forEach(function(){return p()}),u(Object(P.getIn)(n,c))},[c,u,p,n]),_=Object(i.useCallback)(function(e){var t=Object(P.getIn)(n,c)||[],a=e.target,r=a.value;a.checked?h(r):g(t.indexOf(r)),u(Object(P.getIn)(n,c))},[c,u,h,g,n]);return s.a.createElement(F.a,{hasError:Object(P.getIn)(a,c)&&Object(P.getIn)(a,c).length},l,s.a.createElement(D,{onSelectedAll:f,onSelectedNone:v,testId:r}),s.a.createElement(z,{fieldType:I.a.checkbox,id:r,name:c,onChange:_,options:m,value:Object(P.getIn)(n,c)||[]}),s.a.createElement(x.a,{name:c,testId:Object(o.kebabCase)(c)+"-field-error-message"}))},K=Object(i.memo)(function(e){var t=e.id,n=e.label,r=e.name,l=e.onChange,c=e.options,d=Object(i.useCallback)(function(e){return s.a.createElement(B,a.__assign({id:t,label:n,name:r,onChange:l,options:c},Object(o.pick)(e,["form","pop","push","remove"])))},[t,n,r,l,c]);return s.a.createElement(P.FieldArray,{name:r,render:d})}),q={address1:"address.address_line_1_label",address2:"address.address_line_2_label",city:"address.city_label",company:"address.company_name_label",countryCode:"address.country_label",firstName:"address.first_name_label",lastName:"address.last_name_label",phone:"address.phone_number_label",postalCode:"address.postal_code_label",stateOrProvince:"address.state_label",stateOrProvinceCode:"address.state_label"},H={address1:"address-line1",address2:"address-line2",city:"address-level2",company:"organization",countryCode:"country",firstName:"given-name",lastName:"family-name",phone:"tel",postalCode:"postal-code",stateOrProvince:"address-level1",stateOrProvinceCode:"address-level1"},W=Object(i.memo)(function(e){var t=e.field,n=t.name,r=t.label,o=t.custom,l=t.required,c=t.options,d=t.max,u=t.min,h=t.maxLength,v=e.fieldType,_=e.parentFieldName,b=e.onChange,C=e.displayField,y=e.requiredPhoneNumberFinalPS,E=e.placeholder,O=n,S=f(O),A=_?_+"."+n:n;"phone"===A&&!1===y&&(l=!1);var k=q[n],w=Object(i.useMemo)(function(){return s.a.createElement(j.a,{htmlFor:S},o?r:k&&s.a.createElement(m.a,{id:k}),!l&&s.a.createElement(s.a.Fragment,null,"",s.a.createElement("small",{className:"optimizedCheckout-contentSecondary"},s.a.createElement(m.a,{id:"common.optional_text"}))))},[o,S,r,l,k]),N=Object(i.useCallback)(function(e){var t=e.field;return s.a.createElement(z,a.__assign({},t,{autoComplete:H[O],fieldType:v,id:S,max:d,maxLength:h||void 0,min:u,options:c&&c.items,placeholder:E||c&&c.helperLabel,rows:c&&c.rows}))},[O,S,v,d,h,u,c,C,E]);return s.a.createElement("div",{className:"dynamic-form-field dynamic-form-field--"+g(O)+" "+(C?"activeFieldPS":"inActiveFieldPS")},v===I.a.checkbox?s.a.createElement(K,{id:S,label:w,name:A,onChange:b,options:c&&c.items||[]}):s.a.createElement(p.a,{input:N,label:w,name:A,onChange:b}))}),Y={countryCode:"address.select_country_action",stateOrProvince:"address.select_state_action",stateOrProvinceCode:"address.select_state_action"},G="address1",J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerRef=Object(i.createRef)(),t.handleDynamicFormFieldChange=Object(r.memoize)(function(e){return function(n){t.syncNonFormikValue(e,n)}}),t.handleAutocompleteChange=function(e,n){n||t.syncNonFormikValue(G,e)},t.handleAutocompleteSelect=function(e,n){var r=n.value,i=t.props,s=i.countries,l=i.setFieldValue,c=void 0===l?o.noop:l,d=i.onChange,m=void 0===d?o.noop:d,p=function(e,t){if(void 0===t&&(t=[]),!e||!e.address_components)return{};var n=u.create(e),r=n.getState(),o=n.getCountry(),i=t&&t.find(function(e){return o===e.code}),s=n.getStreet2();return a.__assign({address2:s,city:n.getCity(),countryCode:o,postalCode:n.getPostCode()},r?function(e,t){void 0===t&&(t=[]);var n=t.find(function(t){var n=t.code,a=t.name;return n===e||a===e});return n?{stateOrProvince:n.name,stateOrProvinceCode:n.code}:{stateOrProvince:t.length?"":e,stateOrProvinceCode:""}}(r,i&&i.subdivisions):{})}(e,s);Object(o.forIn)(p,function(e,t){c(t,e),m(t,e)}),r&&t.syncNonFormikValue(G,r)},t.syncNonFormikValue=function(e,n){var a=t.props,r=a.formFields,i=a.setFieldValue,s=void 0===i?o.noop:i,l=a.onChange,c=void 0===l?o.noop:l,d=r.filter(function(e){return e.custom&&e.fieldType===I.a.date}).map(function(e){return e.name});(e===G||d.indexOf(e)>-1)&&s(e,n),c(e,n)},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.containerRef.current;e&&(this.nextElement=e.querySelector('[autocomplete="address-line2"]'))},t.prototype.render=function(){var e=this,t=this.props,n=t.formFields,a=t.fieldName,r=t.language,o=t.countriesWithAutocomplete,i=t.countryCode,l=t.formFieldsShowHide,c=t.googleMapsApiKey,d=t.onAutocompleteToggle,u=t.requiredPhoneNumberPS;return s.a.createElement("div",{className:"checkout-address",ref:this.containerRef},n.map(function(t){var n=t.name,m=Y[n];if("address1"===n&&c&&o)return s.a.createElement(N,{apiKey:c,countryCode:i,field:t,key:t.id,nextElement:e.nextElement||void 0,onChange:e.handleAutocompleteChange,onSelect:e.handleAutocompleteSelect,onToggleOpen:d,parentFieldName:a,supportedCountries:o});var p=l;return"firstName"!==n&&"lastName"!==n||(p=!0),s.a.createElement(W,{displayField:p,field:t,fieldType:e.getDynamicFormFieldType(t),key:t.id+"-"+t.name,onChange:e.handleDynamicFormFieldChange(n),parentFieldName:t.custom?a?a+".customFields":"customFields":a,placeholder:m&&r.translate(m),requiredPhoneNumberFinalPS:u})}))},t.prototype.getDynamicFormFieldType=function(e){var t=e.custom,n=e.name,a=e.fieldType,r=e.type,o=e.secret;return t?"text"===a?"integer"===r?I.a.number:o?I.a.password:I.a.text:a:{phone:I.a.telephone,countryCode:I.a.dropdown,stateOrProvinceCode:I.a.dropdown}[n]||I.a.text},t}(i.Component);t.a=Object(l.a)(J)},1414:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(4),o=n(0),i=n.n(o),s=n(1332),l=n(1255),c=n(461),d=n(1231),u=n(1202),m=n(1281),p=n(1235),h=n(1227),g=n(67),f=n(48),v=n(1333),_=n(1334),b=n(1405),C=n(458),y=n(457),E=n(200),O=n(1383),S=n(1226),A=n(1233),k=n(1234),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isResettingAddress:!1},t.addressFormRef=Object(o.createRef)(),t.handleSelectAddress=function(e){return a.__awaiter(t,void 0,void 0,function(){var t,n,r,o;return a.__generator(this,function(a){switch(a.label){case 0:t=this.props,n=t.updateAddress,r=t.onUnhandledError,this.setState({isResettingAddress:!0}),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,n(e)];case 2:return a.sent(),[3,5];case 3:return o=a.sent(),r(o),[3,5];case 4:return this.setState({isResettingAddress:!1}),[7];case 5:return[2]}})})},t.handleUseNewAddress=function(){t.handleSelectAddress({})},t}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.googleMapsApiKey,n=e.billingAddress,a=e.countriesWithAutocomplete,r=e.customer.addresses,o=e.getFields,s=e.countries,l=e.isUpdating,c=e.setFieldValue,d=e.shouldShowOrderComments,m=e.values,p=e.requiredBillingPhoneNumber,g=this.state.isResettingAddress,f=r&&r.length>0,C=n&&Object(v.a)(n,r,o(n.countryCode));return i.a.createElement(A.a,{autoComplete:"on"},i.a.createElement(k.a,{id:"checkoutBillingAddress",ref:this.addressFormRef},f&&i.a.createElement(k.a,{id:"billingAddresses"},i.a.createElement(h.a,{isLoading:g},i.a.createElement(_.a,{addresses:r,onSelectAddress:this.handleSelectAddress,onUseNewAddress:this.handleUseNewAddress,selectedAddress:C?n:void 0}))),!C&&i.a.createElement(h.a,{isLoading:g},i.a.createElement(b.a,{countries:s,countriesWithAutocomplete:a,countryCode:m.countryCode,formFields:o(m.countryCode),formFieldsShowHide:!0,googleMapsApiKey:t,requiredPhoneNumberPS:p,setFieldValue:c}))),d&&i.a.createElement(O.a,null),i.a.createElement("div",{className:"form-actions"},i.a.createElement(S.c,{disabled:l||g,id:"checkout-billing-continue",isLoading:l||g,type:"submit",variant:S.b.Primary},i.a.createElement(u.a,{id:"common.continue_action"}))))},t}(o.PureComponent),N=Object(E.a)(Object(g.withFormik)({handleSubmit:function(e,t){(0,t.props.onSubmit)(e)},mapPropsToValues:function(e){var t=e.getFields,n=e.customerMessage,r=e.billingAddress;return a.__assign({},Object(C.a)(t(r&&r.countryCode),r),{orderComment:n})},isInitialValid:function(e){var t=e.billingAddress,n=e.getFields,a=e.language,r=e.requiredBillingPhoneNumber;return!!t&&Object(y.a)({language:a,formFields:n(t.countryCode),requiredBillingPhoneNumber:r}).isValidSync(t)},validationSchema:function(e){var t=e.language,n=e.getFields,a=e.requiredBillingPhoneNumber;return Object(f.lazy)(function(e){return Object(y.a)({language:t,formFields:n(e&&e.countryCode),requiredBillingPhoneNumber:a})})},enableReinitialize:!0})(w)),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSubmit=function(e){return a.__awaiter(t,void 0,void 0,function(){var t,n,r,o,i,c,d,u,m,p,h=e.orderComment,g=a.__rest(e,["orderComment"]);return a.__generator(this,function(e){switch(e.label){case 0:t=this.props,n=t.updateAddress,r=t.updateCheckout,o=t.customerMessage,i=t.billingAddress,c=t.navigateNextStep,d=t.onUnhandledError,u=[],(m=Object(s.a)(g))&&!Object(l.a)(m,i)&&u.push(n(m)),o!==h&&u.push(r({customerMessage:h})),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(u)];case 2:return e.sent(),c(),[3,4];case 3:return p=e.sent(),d(p),[3,4];case 4:return[2]}})})},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){return a.__awaiter(this,void 0,Promise,function(){var e,t,n,o,i,s;return a.__generator(this,function(a){switch(a.label){case 0:e=this.props,t=e.initialize,n=e.onReady,o=void 0===n?r.noop:n,i=e.onUnhandledError,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t()];case 2:return a.sent(),o(),[3,4];case 3:return s=a.sent(),i(s),[3,4];case 4:return[2]}})})},t.prototype.render=function(){var e=this.props,t=e.updateAddress,n=e.isInitializing,r=a.__rest(e,["updateAddress","isInitializing"]);return i.a.createElement("div",{className:"checkout-form"},i.a.createElement("div",{className:"form-legend-container"},i.a.createElement(p.a,{testId:"billing-address-heading"},i.a.createElement(u.a,{id:"billing.billing_address_heading"}))),i.a.createElement(h.a,{isLoading:n,unmountContentWhenLoading:!0},i.a.createElement(N,a.__assign({},r,{onSubmit:this.handleSubmit,updateAddress:t}))))},t}(o.Component);t.default=Object(c.a)(function(e){var t=e.checkoutService,n=e.checkoutState,a=n.data,r=a.getCheckout,o=a.getConfig,i=a.getCart,s=a.getCustomer,l=a.getBillingAddress,c=a.getBillingAddressFields,u=a.getBillingCountries,p=n.statuses,h=p.isLoadingBillingCountries,g=p.isUpdatingBillingAddress,f=p.isUpdatingCheckout,v=o(),_=s(),b=r(),C=i();if(!(v&&_&&b&&C))return null;var y=v.checkoutSettings,E=y.enableOrderComments,O=y.googleMapsApiKey,S=["US","CA","AU","NZ"];return y.features["CHECKOUT-4183.checkout_google_address_autocomplete_uk"]&&S.push("GB"),{billingAddress:l(),countries:u()||d.a,countriesWithAutocomplete:S,customer:_,customerMessage:b.customerMessage,getFields:c,googleMapsApiKey:O,initialize:t.loadBillingAddressFields,isInitializing:h(),isUpdating:g()||f(),shouldShowOrderComments:E&&Object(m.a)(C)<1,updateAddress:t.updateBillingAddress,updateCheckout:t.updateCheckout}})(j)}}]);
//# sourceMappingURL=billing-b5e27256.js.map